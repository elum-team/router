"use strict";var e=require("elum-state");const t={panel:"default",modal:void 0,popout:void 0,stay:!1,freeze:!1,params:{}},a={startup:[t],error:[t],main:[t]},o=e.atom({key:"router_active_view",default:"startup"}),r=e.atom({key:"router_active_panel",default:t.panel}),p=e.atom({key:"router_active_modal",default:t.modal}),s=e.atom({key:"router_active_popout",default:t.popout}),l=e.atom({key:"router_active_params",default:t.params}),n=(e,t)=>Object.keys(e).every((a=>e[a]===t[a]||"[object Object]"===Object.prototype.toString.call(e[a])&&n(e[a],t[a]))),u=["view","panel","modal","popout"];exports.ACTIVE_MODAL=p,exports.ACTIVE_PANEL=r,exports.ACTIVE_PARAMS=l,exports.ACTIVE_POPOUT=s,exports.ACTIVE_VIEW=o,exports.backPage=(t={ignoreFreeze:!1,toStay:!1})=>{const n=e.getter(o),u=a[n],m=u[u.length-1],i=((e,t)=>{const a=typeof e;if("boolean"===a&&!e)return t.length-2;let o=0;for(let r=t.length-1;r>0;r--){const p=t[r];if("boolean"===a&&p.stay||p.stay===e){o=r;break}}return o})(t.toStay,u),c=u[i];if(1===u.length)return void console.log("end app");if(m.freeze&&!t.ignoreFreeze)return;u.splice(i+1);const d={panel:c.panel,modal:c.modal,popout:c.popout,stay:c.stay,freeze:c.freeze,params:c.params};e.setter(o,n),e.setter(r,d.panel),e.setter(p,d.modal),e.setter(s,d.popout),e.setter(l,d.params)},exports.nextPage=m=>{const i=e.getter(o),c=m.view||i,d=a[c],f=d[d.length-1],y={panel:m.panel||f.panel,modal:m.modal||f.modal,popout:m.popout||f.popout,stay:m.stay||t.stay,freeze:m.freeze||t.freeze,params:m.params||f.params};for(let e=u.length-1;e>=0;e--){const a=u[e];if(m[a])break;y[a]=t[a]}n(f,y)||(e.setter(o,c),e.setter(r,y.panel),e.setter(p,y.modal),e.setter(s,y.popout),e.setter(l,y.params),d.push(y)),m.clear&&i!==c&&(a[i]=[t])};
