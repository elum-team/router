"use strict";var e=require("elum-state"),t=require("@vkontakte/vk-bridge"),a=require("react");const r={panel:"default",modal:void 0,popout:void 0,stay:!1,freeze:!1,params:{}},o={startup:[r],error:[r],main:[r]},s=e.atom({key:"router_active_view",default:"startup"}),p=e.atom({key:"router_active_panel",default:r.panel}),l=e.atom({key:"router_active_modal",default:r.modal}),u=e.atom({key:"router_active_popout",default:r.popout}),n=e.atom({key:"router_active_params",default:r.params}),m=(e,t)=>Object.keys(e).every((a=>e[a]===t[a]||"[object Object]"===Object.prototype.toString.call(e[a])&&m(e[a],t[a]))),i=["view","panel","modal","popout"],c={view:s,panel:p,modal:l,popout:u};exports.backPage=(a={ignoreFreeze:!1,toStay:!1})=>{const r=e.getter(s),m=o[r],i=m[m.length-1],c=((e,t)=>{const a=typeof e;if("boolean"===a&&!e)return t.length-2;let r=0;for(let o=t.length-1;o>0;o--){const s=t[o];if("boolean"===a&&s.stay||s.stay===e){r=o;break}}return r})(a.toStay,m),d=m[c];if(1===m.length)return void t.send("VKWebAppClose",{status:"success"});if(i.freeze&&!a.ignoreFreeze)return;m.splice(c+1);const f={panel:d.panel,modal:d.modal,popout:d.popout,stay:d.stay,freeze:d.freeze,params:d.params};e.setter(s,r),e.setter(p,f.panel),e.setter(l,f.modal),e.setter(u,f.popout),e.setter(n,f.params)},exports.nextPage=t=>{const a=e.getter(s),c=t.view||a,d=o[c],f=d[d.length-1],y={panel:t.panel||f.panel,modal:t.modal||f.modal,popout:t.popout||f.popout,stay:t.stay||r.stay,freeze:t.freeze||r.freeze,params:t.params||f.params};for(let e=i.length-1;e>=0;e--){const a=i[e];if(t[a])break;y[a]=r[a]}m(f,y)||(e.setter(s,c),e.setter(p,y.panel),e.setter(l,y.modal),e.setter(u,y.popout),e.setter(n,y.params),d.push(y)),t.clear&&a!==c&&(o[a]=[r])},exports.useParams=()=>{const[t]=a.useState(e.getter(n));return t},exports.useRouter=t=>e.useGlobalValue(c[t]);
